<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ 2</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
        }

        .status-bar {
            height: 24px;
            background: #6200ea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            color: white;
            font-size: 14px;
            font-weight: 500;
        }

        .app-bar {
            display: none;
        }

        .content {
            padding: 16px;
            padding-bottom: 80px;
            max-width: 600px;
            margin: 0 auto;
            padding-top: 24px;
        }

        .recipes-stories {
            margin-bottom: 16px;
            display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }

        .stories-container {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding: 8px 4px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .stories-container::-webkit-scrollbar {
            display: none;
        }

        .story-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 70px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .story-item:hover {
            transform: scale(1.05);
        }

        .story-circle {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 6px;
            border: 3px solid transparent;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .story-item.active .story-circle {
            border-color: #6200ea;
            background: linear-gradient(135deg, #6200ea, #7c4dff);
            color: white;
        }

        .story-item.add-new .story-circle {
            background: linear-gradient(135deg, #ff4081, #f50057);
            color: white;
            font-size: 28px;
            font-weight: 300;
        }

        .story-name {
            font-size: 12px;
            color: #666;
            text-align: center;
            font-weight: 500;
            max-width: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .story-item.active .story-name {
            color: #6200ea;
            font-weight: 600;
        }

        .input-section {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .input-container {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .input-field {
            flex: 1;
            border: none;
            outline: none;
            font-size: 16px;
            padding: 12px 16px;
            background: #f5f5f5;
            border-radius: 8px;
            font-family: 'Roboto', sans-serif;
        }

        .add-button {
            background: #6200ea;
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 24px;
            color: white;
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
        }

        .add-button:hover {
            background: #5a00d6;
            transform: scale(1.05);
        }

        .category-section {
            background: white;
            border-radius: 12px;
            margin-bottom: 16px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .category-header {
            background: linear-gradient(135deg, #6200ea, #7c4dff);
            color: white;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .category-title {
            font-size: 18px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-count {
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 4px 8px;
            font-size: 12px;
            font-weight: 500;
        }

        .category-items {
            padding: 8px 0;
        }

        .item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            transition: background 0.2s;
            cursor: pointer;
        }

        .item:hover {
            background: #f5f5f5;
        }

        .item.completed {
            opacity: 0.6;
        }

        .item.completed .item-text {
            text-decoration: line-through;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #6200ea;
            border-radius: 4px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox.checked {
            background: #6200ea;
        }

        .checkbox.checked::after {
            content: '‚úì';
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .item-text {
            flex: 1;
            font-size: 16px;
            color: #333;
        }

        .delete-button {
            color: #999;
            cursor: pointer;
            transition: color 0.2s;
            font-size: 20px;
        }

        .delete-button:hover {
            color: #f44336;
        }

        .fab {
            position: fixed;
            bottom: 16px;
            right: 16px;
            width: 56px;
            height: 56px;
            background: #ff4081;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(255,64,129,0.4);
            transition: all 0.2s;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(255,64,129,0.5);
        }

        .fab .material-icons {
            color: white;
            font-size: 24px;
        }

        .category-bread { background: linear-gradient(135deg, #ff9800, #ff6f00); }
        .category-dairy { background: linear-gradient(135deg, #2196f3, #1976d2); }
        .category-meat { background: linear-gradient(135deg, #f44336, #d32f2f); }
        .category-vegetables { background: linear-gradient(135deg, #4caf50, #388e3c); }
        .category-sweets { background: linear-gradient(135deg, #e91e63, #c2185b); }
        .category-grocery { background: linear-gradient(135deg, #9c27b0, #7b1fa2); }
    </style>
</head>
<body>




    <div class="content">
        <div class="recipes-stories">
            <div class="stories-container" id="storiesContainer">
                <div class="story-item active" data-recipe="main" onclick="switchToRecipe('main')">
                    <div class="story-circle">üõí</div>
                    <div class="story-name">–û—Å–Ω–æ–≤–Ω–æ–π</div>
                </div>
                <div class="story-item add-new" onclick="createNewRecipe()">
                    <div class="story-circle">+</div>
                    <div class="story-name">–ù–æ–≤—ã–π</div>
                </div>
            </div>
        </div>

        <div class="input-section">
            <div class="input-container">
                <input type="text" class="input-field" placeholder="–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç..." id="productInput">
                <button class="add-button" onclick="addProduct()">+</button>
            </div>
        </div>

        <div id="categoriesContainer">
            <!-- –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ - –ø—Ä–æ–¥—É–∫—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º -->
        </div>
    </div>

    <button class="fab" onclick="scrollToTop()">
        <span class="material-icons">‚Üë</span>
    </button>

    <script>
        let currentRecipe = 'main';
        
        let recipeData = {
            main: { name: '–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫', products: [] }
        };

        function saveCurrentRecipeData() {
            const products = [];
            document.querySelectorAll('.item').forEach(item => {
                const text = item.querySelector('.item-text').textContent;
                const isCompleted = item.classList.contains('completed');
                const categorySection = item.closest('.category-section');
                const categoryId = categorySection.getAttribute('data-category');
                
                products.push({
                    text: text,
                    completed: isCompleted,
                    category: categoryId
                });
            });
            
            recipeData[currentRecipe].products = products;
        }

        function updateActiveStory(recipeId) {
            document.querySelectorAll('.story-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector('[data-recipe="' + recipeId + '"]').classList.add('active');
        }

        function updateAppTitle(title) {
            document.getElementById('appTitle').textContent = title;
        }

        function switchToRecipe(recipeId) {
            if (document.querySelectorAll('.item').length > 0) {
                saveCurrentRecipeData();
            }
            
            currentRecipe = recipeId;
            
            updateActiveStory(recipeId);
            updateAppTitle(recipeData[recipeId].name);
            loadRecipeData(recipeId);
        }

        function createNewRecipe() {
            const name = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–µ—Ü–µ–ø—Ç–∞:');
            if (!name) return;
            
            const emoji = prompt('–í—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ–¥–∑–∏ –¥–ª—è —Ä–µ—Ü–µ–ø—Ç–∞:', 'üçΩÔ∏è');
            const recipeId = 'recipe_' + Date.now();
            
            recipeData[recipeId] = { name: name, products: [] };
            
            // –ü–æ–∫–∞–∑–∞—Ç—å stories-—Å–µ–∫—Ü–∏—é –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä–≤–æ–≥–æ —Ä–µ—Ü–µ–ø—Ç–∞
            const storiesSection = document.querySelector('.recipes-stories');
            if (storiesSection.style.display === 'none') {
                storiesSection.style.display = 'block';
            }
            
            const newStory = document.createElement('div');
            newStory.className = 'story-item';
            newStory.setAttribute('data-recipe', recipeId);
            newStory.onclick = function() { switchToRecipe(recipeId); };
            
            newStory.innerHTML = '<div class="story-circle">' + (emoji || 'üçΩÔ∏è') + '</div><div class="story-name">' + name + '</div>';
            
            const addButton = document.querySelector('.story-item.add-new');
            addButton.parentNode.insertBefore(newStory, addButton);
            
            switchToRecipe(recipeId);
        }

        function loadRecipeData(recipeId) {
            document.getElementById('categoriesContainer').innerHTML = '';
            
            const products = recipeData[recipeId].products;
            
            products.forEach(product => {
                addProductToUI(product.text, product.category, product.completed);
            });
        }

        function addProductToUI(productText, categoryId, isCompleted) {
            isCompleted = isCompleted || false;
            const category = categories[categoryId];
            
            let categorySection = document.querySelector('[data-category="' + categoryId + '"]');
            
            if (!categorySection) {
                categorySection = createCategorySection(categoryId, category);
                document.getElementById('categoriesContainer').appendChild(categorySection);
            }
            
            const itemsContainer = categorySection.querySelector('.category-items');
            const item = createProductItem(productText);
            
            if (isCompleted) {
                item.classList.add('completed');
                item.querySelector('.checkbox').classList.add('checked');
            }
            
            itemsContainer.appendChild(item);
            updateCategoryCount(categorySection);
        }

        const categories = {
            'bread': {
                name: '–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞',
                icon: 'ü•ñ',
                class: 'category-bread',
                keywords: ['—Ö–ª–µ–±', '–±—É–ª–æ—á–∫–∞', '–±–∞—Ç–æ–Ω', '–±–∞–≥–µ—Ç', '–ª–∞–≤–∞—à', '–ø–∏—Ç–∞', '–∫—Ä—É–∞—Å—Å–∞–Ω', '–∫–µ–∫—Å', '–ø–∏—Ä–æ–≥', '—Ç–æ—Ä—Ç', '–ø–µ—á–µ–Ω—å–µ', '—Å—É—à–∫–∏', '–±–∞—Ä–∞–Ω–∫–∏']
            },
            'dairy': {
                name: '–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã',
                icon: 'ü•õ',
                class: 'category-dairy',
                keywords: ['–º–æ–ª–æ–∫–æ', '–∫–µ—Ñ–∏—Ä', '—Ä—è–∂–µ–Ω–∫–∞', '—Ç–≤–æ—Ä–æ–≥', '—Å–º–µ—Ç–∞–Ω–∞', '–π–æ–≥—É—Ä—Ç', '—Å—ã—Ä', '–º–∞—Å–ª–æ', '—Å–ª–∏–≤–∫–∏', '–ø—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∞']
            },
            'meat': {
                name: '–ú—è—Å–æ –∏ —Ä—ã–±–∞',
                icon: 'ü•©',
                class: 'category-meat',
                keywords: ['–º—è—Å–æ', '–≥–æ–≤—è–¥–∏–Ω–∞', '—Å–≤–∏–Ω–∏–Ω–∞', '–∫—É—Ä–∏—Ü–∞', '–∏–Ω–¥–µ–π–∫–∞', '—Ä—ã–±–∞', '–∫–æ–ª–±–∞—Å–∞', '—Å–æ—Å–∏—Å–∫–∏', '—Ñ–∞—Ä—à', '–∫–æ—Ç–ª–µ—Ç—ã', '–æ–∫–æ—Ä–æ–∫', '–±–µ–∫–æ–Ω']
            },
            'vegetables': {
                name: '–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã',
                icon: 'ü•ï',
                class: 'category-vegetables',
                keywords: ['–ø–æ–º–∏–¥–æ—Ä', '–æ–≥—É—Ä–µ—Ü', '–º–æ—Ä–∫–æ–≤—å', '–ª—É–∫', '–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å', '–∫–∞–ø—É—Å—Ç–∞', '—è–±–ª–æ–∫–æ', '–±–∞–Ω–∞–Ω', '–∞–ø–µ–ª—å—Å–∏–Ω', '–≥—Ä—É—à–∞', '–≤–∏–Ω–æ–≥—Ä–∞–¥', '–∫–ª—É–±–Ω–∏–∫–∞', '–∞–≤–æ–∫–∞–¥–æ', '–ø–µ—Ä–µ—Ü', '—á–µ—Å–Ω–æ–∫']
            },
            'sweets': {
                name: '–°–ª–∞–¥–æ—Å—Ç–∏',
                icon: 'üç∞',
                class: 'category-sweets',
                keywords: ['—à–æ–∫–æ–ª–∞–¥', '–∫–æ–Ω—Ñ–µ—Ç—ã', '–º–∞—Ä–º–µ–ª–∞–¥', '–∑–µ—Ñ–∏—Ä', '–ø–∞—Å—Ç–∏–ª–∞', '—Ö–∞–ª–≤–∞', '–∫–∞—Ä–∞–º–µ–ª—å', '–ª–µ–¥–µ–Ω—Ü—ã', '–∂–≤–∞—á–∫–∞', '–º–æ—Ä–æ–∂–µ–Ω–æ–µ']
            },
            'grocery': {
                name: '–ë–∞–∫–∞–ª–µ—è',
                icon: 'üì¶',
                class: 'category-grocery',
                keywords: ['–∫—Ä—É–ø–∞', '—Ä–∏—Å', '–≥—Ä–µ—á–∫–∞', '–º–∞–∫–∞—Ä–æ–Ω—ã', '–º—É–∫–∞', '—Å–∞—Ö–∞—Ä', '—Å–æ–ª—å', '–º–∞—Å–ª–æ', '—É–∫—Å—É—Å', '—Å–ø–µ—Ü–∏–∏', '–∫–æ–Ω—Å–µ—Ä–≤—ã', '—á–∞–π', '–∫–æ—Ñ–µ', '—Å–æ–∫']
            }
        };

        function parseProduct(input) {
            const text = input.trim();
            
            const patterns = [
                /^(\d+)\s+(.+)$/,
                /^(\d+)\s*—à—Ç\.?\s+(.+)$/i,
                /^(\d+)\s*—à—Ç—É–∫[–∏–∞]?\s+(.+)$/i,
                /^(\d+)\s*–∫–≥\.?\s+(.+)$/i,
                /^(\d+)\s*–ª\.?\s+(.+)$/i,
                /^(\d+)\s*–≥\.?\s+(.+)$/i
            ];
            
            for (let pattern of patterns) {
                const match = text.match(pattern);
                if (match) {
                    const quantity = parseInt(match[1]);
                    const name = match[2].trim();
                    return { name, quantity };
                }
            }
            
            return { name: text, quantity: 1 };
        }

        function categorizeProduct(productName) {
            const name = productName.toLowerCase();
            
            for (let categoryId in categories) {
                const category = categories[categoryId];
                for (let keyword of category.keywords) {
                    if (name.includes(keyword)) {
                        return categoryId;
                    }
                }
            }
            
            return 'grocery';
        }

        function addProduct() {
            const input = document.getElementById('productInput');
            const inputText = input.value.trim();
            
            if (!inputText) return;
            
            const parsed = parseProduct(inputText);
            const categoryId = categorizeProduct(parsed.name);
            
            let displayName = parsed.name;
            if (parsed.quantity > 1) {
                displayName += ' (' + parsed.quantity + ' —à—Ç)';
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –ø—Ä–æ–¥—É–∫—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–ø–∏—Å–∫–µ
            let existingStatus = false;
            if (currentRecipe !== 'main') {
                const mainProducts = recipeData.main.products;
                for (let i = 0; i < mainProducts.length; i++) {
                    if (mainProducts[i].text === displayName) {
                        existingStatus = mainProducts[i].completed;
                        break;
                    }
                }
            }
            
            addProductToUI(displayName, categoryId, existingStatus);
            
            // –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–∏—Å–æ–∫, –¥–æ–±–∞–≤–∏—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–∏—Å–æ–∫
            if (currentRecipe !== 'main') {
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–ø–∏—Å–∫–µ
                let alreadyExists = false;
                const mainProducts = recipeData.main.products;
                for (let i = 0; i < mainProducts.length; i++) {
                    if (mainProducts[i].text === displayName) {
                        alreadyExists = true;
                        break;
                    }
                }
                
                if (!alreadyExists) {
                    recipeData.main.products.push({
                        text: displayName,
                        completed: existingStatus,
                        category: categoryId
                    });
                }
            }
            
            input.value = '';
        }

        function createCategorySection(categoryId, category) {
            const section = document.createElement('div');
            section.className = 'category-section';
            section.setAttribute('data-category', categoryId);
            
            section.innerHTML = '<div class="category-header ' + category.class + '"><div class="category-title"><span style="font-size: 20px; margin-right: 8px;">' + category.icon + '</span>' + category.name + '</div><div class="category-count">0</div></div><div class="category-items"></div>';
            
            return section;
        }

        function createProductItem(productName) {
            const item = document.createElement('div');
            item.className = 'item';
            
            item.innerHTML = '<div class="checkbox" onclick="toggleItem(this)"></div><div class="item-text">' + productName + '</div><span class="delete-button" onclick="deleteItem(this)">√ó</span>';
            
            return item;
        }

        function toggleItem(checkbox) {
            const item = checkbox.closest('.item');
            const isChecked = checkbox.classList.contains('checked');
            const productText = item.querySelector('.item-text').textContent;
            
            if (isChecked) {
                checkbox.classList.remove('checked');
                item.classList.remove('completed');
                syncProductStatus(productText, false);
            } else {
                checkbox.classList.add('checked');
                item.classList.add('completed');
                syncProductStatus(productText, true);
            }
        }

        function syncProductStatus(productText, isCompleted) {
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–æ –≤—Å–µ—Ö —Ä–µ—Ü–µ–ø—Ç–∞—Ö
            for (let recipeId in recipeData) {
                const products = recipeData[recipeId].products;
                for (let i = 0; i < products.length; i++) {
                    if (products[i].text === productText) {
                        products[i].completed = isCompleted;
                    }
                }
            }
            
            // –û–±–Ω–æ–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ –≤–æ –≤—Å–µ—Ö –≤–∏–¥–∏–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            document.querySelectorAll('.item').forEach(itemElement => {
                const itemText = itemElement.querySelector('.item-text').textContent;
                if (itemText === productText) {
                    const itemCheckbox = itemElement.querySelector('.checkbox');
                    if (isCompleted) {
                        itemCheckbox.classList.add('checked');
                        itemElement.classList.add('completed');
                    } else {
                        itemCheckbox.classList.remove('checked');
                        itemElement.classList.remove('completed');
                    }
                }
            });
        }

        function deleteItem(deleteButton) {
            const item = deleteButton.closest('.item');
            const categorySection = deleteButton.closest('.category-section');
            const productText = item.querySelector('.item-text').textContent;
            
            // –£–¥–∞–ª–∏—Ç—å –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ—Ü–µ–ø—Ç–∞
            const currentProducts = recipeData[currentRecipe].products;
            for (let i = currentProducts.length - 1; i >= 0; i--) {
                if (currentProducts[i].text === productText) {
                    currentProducts.splice(i, 1);
                    break;
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–¥—É–∫—Ç –≤ –¥—Ä—É–≥–∏—Ö —Ä–µ—Ü–µ–ø—Ç–∞—Ö
            let existsInOtherRecipes = false;
            for (let recipeId in recipeData) {
                if (recipeId !== currentRecipe) {
                    const products = recipeData[recipeId].products;
                    for (let i = 0; i < products.length; i++) {
                        if (products[i].text === productText) {
                            existsInOtherRecipes = true;
                            break;
                        }
                    }
                    if (existsInOtherRecipes) break;
                }
            }
            
            // –ï—Å–ª–∏ –ø—Ä–æ–¥—É–∫—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö —Ä–µ—Ü–µ–ø—Ç–∞—Ö –∏ –º—ã –Ω–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–ø–∏—Å–∫–µ,
            // —É–¥–∞–ª–∏—Ç—å –µ–≥–æ –∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
            if (!existsInOtherRecipes && currentRecipe !== 'main') {
                const mainProducts = recipeData.main.products;
                for (let i = mainProducts.length - 1; i >= 0; i--) {
                    if (mainProducts[i].text === productText) {
                        mainProducts.splice(i, 1);
                        break;
                    }
                }
            }
            
            item.remove();
            updateCategoryCount(categorySection);
            
            const itemsContainer = categorySection.querySelector('.category-items');
            if (itemsContainer.children.length === 0) {
                categorySection.remove();
            }
        }

        function updateCategoryCount(categorySection) {
            const items = categorySection.querySelectorAll('.item');
            const countElement = categorySection.querySelector('.category-count');
            countElement.textContent = items.length;
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        document.getElementById('productInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addProduct();
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            if (document.querySelectorAll('.item').length > 0) {
                saveCurrentRecipeData();
            }
            
            document.querySelectorAll('.category-section').forEach(updateCategoryCount);
        });
    </script>
</body>
</html>